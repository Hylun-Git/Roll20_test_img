
<input type="hidden" class="sheet-tabstoggle" name="attr_sheetTab"  value="character"  />

<rolltemplate class="sheet-rolltemplate-ATDW">
  <div class="sheet-container sheet-color-{{color}}">
    <div class="sheet-header">
		<img class="sheet-phoenix" src="https://raw.githubusercontent.com/Hylun-Git/Roll20_test_img/main/KSA_Logo_square.png" alt="ATDW Phoenix logo"> 
      {{#title}}<div class="sheet-title">{{title}}</div>{{/title}}
      {{#subtitle}}<div class="sheet-subtitle">{{subtitle}} </div>{{/subtitle}}
    </div>
    <div class="sheet-content">
      {{#allprops() title subtitle desc color}}
      <div class="sheet-key">{{key}}</div>
      <div class="sheet-value">{{value}}</div>
      {{/allprops() title subtitle desc color}}
      {{#desc}}<div class="sheet-desc">{{desc}}</div>{{/desc}}
    </div>
  </div>
</rolltemplate>
   
<rolltemplate class="sheet-rolltemplate-ATDW_shooting">
  <div class="sheet-container sheet-color-{{color}}">
    <div class="sheet-header">
		<img class="sheet-phoenix" src="https://raw.githubusercontent.com/Hylun-Git/Roll20_test_img/main/KSA_Logo_square.png" alt="ATDW Phoenix logo"> 
      {{#title}}<div class="sheet-title">{{title}}</div>{{/title}}
      {{#subtitle}}<div class="sheet-subtitle">{{subtitle}} </div>{{/subtitle}}
    </div>
    <div class="sheet-content">
      {{#allprops() title subtitle desc color}}
      <div class="sheet-key">{{key}}</div>
      <div class="sheet-value">{{value}}</div>
      {{/allprops() title subtitle desc color}}
      {{#desc}}<div class="sheet-desc">{{desc}}</div>{{/desc}}
    </div>
  </div>
</rolltemplate>	
   
<rolltemplate class="sheet-rolltemplate-ATDW_closecombat">
  <div class="sheet-container sheet-color-{{color}}">
    <div class="sheet-header">
		<img class="sheet-phoenix" src="https://raw.githubusercontent.com/Hylun-Git/Roll20_test_img/main/KSA_Logo_square.png" alt="ATDW Phoenix logo"> 
      {{#title}}<div class="sheet-title">{{title}}</div>{{/title}}
      {{#subtitle}}<div class="sheet-subtitle">{{subtitle}} </div>{{/subtitle}}
    </div>
    <div class="sheet-roll_container">
      {{#roll}}<div class="sheet-roll">{{roll}}</div>{{/roll}}
    </div>
    <div class="sheet-content">
      <div class="sheet-key">{{key}}</div>
      <div class="sheet-value">{{value}}</div>
      {{#desc}}<div class="sheet-desc">DEATH{{desc}}</div>{{/desc}}
    </div>
  </div>
</rolltemplate>
	
<div>
    <button type="action" name="act_character">Character</button>
    <button type="action" name="act_backpack">Backpack</button>
</div>

<div class="sheet-character">
   <input type="hidden" name="attr_Emo_ASkill"        value="0"/>
   <input type="hidden" name="attr_Emo_Dmg"           value="0"/>
   <input type="hidden" name="attr_Emo_Rslv"          value="0"/>
   <input type="hidden" name="attr_Emo_Stam"          value="0"/>
   <input type="hidden" name="attr_Emo_CbtSkill"      value="0"/>
   <input type="hidden" name="attr_Emo_Manip"         value="0"/>
   <input type="hidden" name="attr_Emo_NonCbtSkill"   value="0"/>
   
	<input class="Character_name" type="text" name="attr_name" value="">
	<input class="Character_level" type="text" name="attr_level" value="1">
	
	<input class="Stats_STR" type="text" name="attr_Stats_STR" value="8">
	<button type="roll" class="Roll_STR" name="roll_attack" value="&{template:ATDW} {{title=Strength Check}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Stats_STR}}@{AdvSelc}]]}} {{desc=}}"></button>
	
	<input class="Stats_DEX" type="text" name="attr_Stats_DEX" value="8">
	<button type="roll" class="Roll_DEX" name="roll_attack" value="&{template:ATDW} {{title=Dexterity Check}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Stats_DEX}}@{AdvSelc}]]}} {{desc=}}"></button>
	
	<input class="Stats_CON" type="text" name="attr_Stats_CON" value="8">
	<button type="roll" class="Roll_CON" name="roll_attack" value="&{template:ATDW} {{title=Constitution Check}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Stats_CON}}@{AdvSelc}]]}} {{desc=}}"></button>
	
	<input class="Stats_WIL" type="text" name="attr_Stats_WIL" value="8">
	<button type="roll" class="Roll_WIL" name="roll_attack" value="&{template:ATDW} {{title=Will Check}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Stats_WIL}}@{AdvSelc}]]}} {{desc=}}"></button>
	
	<input class="Stats_INT" type="text" name="attr_Stats_INT" value="8">
	<button type="roll" class="Roll_INT" name="roll_attack" value="&{template:ATDW} {{title=Intelligence Check}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Stats_INT}}@{AdvSelc}]]}} {{desc=}}"></button>
	
	<input class="Stats_CHA" type="text" name="attr_Stats_CHA" value="8">
	<button type="roll" class="Roll_CHA" name="roll_attack" value="&{template:ATDW} {{title=Charisme Check}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Stats_CHA}}@{AdvSelc}]]}} {{desc=}}"></button>

	<input class="Stress_StrLevel" type="text" name="attr_Stress_StrLevel" value="0">
	<input class="Stress_NervTic" type="text" name="attr_Stress_NervTic" value="">
   
	<!-- <textarea class="Stress_ObsNegTrait" name="attr_Stress_ObsNegTrait"></textarea> -->
	<!-- <input class="Stress_ObsNegTrait" type="text" name="attr_Stress_ObsNegTrait" value=""> -->
      
   <input type="hidden" name="attr_Skill_Bonus_ArTech"   value="0"/>
   <input type="hidden" name="attr_Skill_Bonus_ClComb"   value="0"/>
   <input type="hidden" name="attr_Skill_Bonus_Percept"  value="0"/>
   <input type="hidden" name="attr_Skill_Bonus_Manipul"  value="0"/>
   <input type="hidden" name="attr_Skill_Bonus_MedAid"   value="0"/>
   <input type="hidden" name="attr_Skill_Bonus_Pilot"    value="0"/>
   <input type="hidden" name="attr_Skill_Bonus_RaComb"   value="0"/>
   <input type="hidden" name="attr_Skill_Bonus_Resolve"  value="0"/>
   <input type="hidden" name="attr_Skill_Bonus_Science"  value="0"/>
   <input type="hidden" name="attr_Skill_Bonus_Stealth"  value="0"/>
   <input type="hidden" name="attr_Skill_Bonus_Survival" value="0"/>
   <input type="hidden" name="attr_Skill_Bonus_Techno"   value="0"/>
	
   
   <!-- <input type="hidden" name="attr_Bonus_Stamina" value="0"/> -->
   <input type="hidden" name="attr_Bonus_Dmg"   value="0"/>
   
	<input class="Stamina" type="text" name="attr_Stamina" value="0">
	<input class="Trauma" type="text" name="attr_Trauma" value="0">
	<input class="Luck" type="text" name="attr_Luck" value="0">
	<input class="Armor" type="text" name="attr_Armor" value="0">
	<input class="Rads" type="text" name="attr_Rads" value="0">
	<input class="Wounds" type="text" name="attr_Wounds" value="0">

	<input class="Skill_ArTech" type="text" name="attr_Skill_ArTech" value="-5">
	<button type="roll" class="Roll_ArTech" name="roll_attack" value="&{template:ATDW} {{title=Arsaidh Technology}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Skill_ArTech}+@{Skill_Bonus_ArTech}}@{AdvSelc}]]}} {{desc=}}"></button>

	<input class="Skill_ClComb" type="text" name="attr_Skill_ClComb" value="0">
	<button type="roll" class="Roll_ClComb" name="roll_attack" value="&{template:ATDW_closecombat} {{title=Close Combat}} {{subtitle=}} {{color=}} {{roll=[[{@{AdvQuant}d20+@{Skill_ClComb}+@{Skill_Bonus_ArTech}}@{AdvSelc}]]}} {{Close Combat Damage=[@{ClCombWeap}](~ClCombDMG)}} {{desc=}}"></button>

	<input class="Skill_Percept" type="text" name="attr_Skill_Percept" value="0">
	<button type="roll" class="Roll_Percept" name="roll_attack" value="&{template:ATDW} {{title=Perception}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Skill_Percept}+@{Skill_Bonus_Percept}}@{AdvSelc}]]}} {{desc=}}"></button>

	<input class="Skill_Manipul" type="text" name="attr_Skill_Manipul" value="0">
	<button type="roll" class="Roll_Manipul" name="roll_attack" value="&{template:ATDW} {{title=Manipulation}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Skill_Manipul}+@{Skill_Bonus_Manipul}}@{AdvSelc}]]}} {{desc=}}"></button>

	<input class="Skill_MedAid" type="text" name="attr_Skill_MedAid" value="0">
	<button type="roll" class="Roll_MedAid" name="roll_attack" value="&{template:ATDW} {{title=Medical Aid}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Skill_MedAid}+@{Skill_Bonus_MedAid}}@{AdvSelc}]]}} {{desc=}}"></button>

	<input class="Skill_Pilot" type="text" name="attr_Skill_Pilot" value="0">
	<button type="roll" class="Roll_Pilot" name="roll_attack" value="&{template:ATDW} {{title=Pilot}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Skill_Pilot}+@{Skill_Bonus_Pilot}}@{AdvSelc}]]}} {{desc=}}"></button>

	<input class="Skill_RaComb" type="text" name="attr_Skill_RaComb" value="0">
	<button type="roll" class="Roll_RaComb" name="roll_attack" value="&{template:ATDW_shooting} {{title=Ranged Combat}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Skill_RaComb}+@{Skill_Bonus_RaComb}}@{AdvSelc}]]}} {{Range Combat Damage=[@{RaCombWeap}](~RaCombDMG)}} {{desc=}}"></button>

	<input class="Skill_Resolve" type="text" name="attr_Skill_Resolve" value="0">
	<button type="roll" class="Roll_Resolve" name="roll_attack" value="&{template:ATDW} {{title=Resolve}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Skill_Resolve}+@{Skill_Bonus_Resolve}}@{AdvSelc}]]}} {{desc=}}"></button>

	<input class="Skill_Science" type="text" name="attr_Skill_Science" value="0">
	<button type="roll" class="Roll_Science" name="roll_attack" value="&{template:ATDW} {{title=Science}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Skill_Science}+@{Skill_Bonus_Science}}@{AdvSelc}]]}} {{desc=}}"></button>

	<input class="Skill_Stealth" type="text" name="attr_Skill_Stealth" value="0">
	<button type="roll" class="Roll_Stealth" name="roll_attack" value="&{template:ATDW} {{title=Stealth}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Skill_Stealth}+@{Skill_Bonus_Stealth}}@{AdvSelc}]]}} {{desc=}}"></button>

	<input class="Skill_Survival" type="text" name="attr_Skill_Survival" value="0">
	<button type="roll" class="Roll_Survival" name="roll_attack" value="&{template:ATDW} {{title=Survival}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Skill_Survival}+@{Skill_Bonus_Survival}}@{AdvSelc}]]}} {{desc=}}"></button>

	<input class="Skill_Techno" type="text" name="attr_Skill_Techno" value="0">
	<button type="roll" class="Roll_Techno" name="roll_attack" value="&{template:ATDW} {{title=Technology}} {{subtitle=}} {{color=}} {{[[{@{AdvQuant}d20+@{Skill_Techno}+@{Skill_Bonus_Techno}}@{AdvSelc}]]}} {{desc=}}"></button>

   <input type="radio" name="attr_Advantage" id="Advantage_0" class="radio-label_Disadvantage" value="0">
	<label for="Advantage_0" class="radio-label_Disadvantage"></label>
	
	<input type="radio" name="attr_Advantage" id="Advantage_1" class="radio-label_Standard" value="1">
	<label for="Advantage_1" class="radio-label_Standard"></label>
	
	<input type="radio" name="attr_Advantage" id="Advantage_2" class="radio-label_Advantage" value="2">
	<label for="Advantage_2" class="radio-label_Advantage"></label>

	<input class="Talent_0" type="text" name="attr_Talent_0" value="">
	<input class="Talent_1" type="text" name="attr_Talent_1" value="">
	<input class="Talent_2" type="text" name="attr_Talent_2" value="">
	<input class="Talent_3" type="text" name="attr_Talent_3" value="">
	<input class="Talent_4" type="text" name="attr_Talent_4" value="">
	
	<!-- <input type="checkbox" name="attr_nope" value="0"> -->
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_0" class="radio-label_Hopeless" value="0">
	<label for="Emotional_State_0" class="radio-label_Hopeless"></label>
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_0_5" class="radio-label_Mid_0" value="0.5">
	<label for="Emotional_State_0_5" class="radio-label_Mid_0"></label>
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_1" class="radio-label_Enraged" value="1">
	<label for="Emotional_State_1" class="radio-label_Enraged"></label>
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_1_5" class="radio-label_Mid_1" value="1.5">
	<label for="Emotional_State_1_5" class="radio-label_Mid_1"></label>
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_2" class="radio-label_Nervous" value="2">
	<label for="Emotional_State_2" class="radio-label_Nervous"></label>
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_2_5" class="radio-label_Mid_2" value="2.5">
	<label for="Emotional_State_2_5" class="radio-label_Mid_2"></label>
   
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_3" class="radio-label_Composed" value="3">
	<label for="Emotional_State_3" class="radio-label_Composed"></label>
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_3_5" class="radio-label_Mid_3" value="3.5">
	<label for="Emotional_State_3_5" class="radio-label_Mid_3"></label>
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_4" class="radio-label_Calm" value="4">
	<label for="Emotional_State_4" class="radio-label_Calm"></label>
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_4_5" class="radio-label_Mid_4" value="4.5">
	<label for="Emotional_State_4_5" class="radio-label_Mid_4"></label>
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_5" class="radio-label_Hopeful" value="5">
	<label for="Emotional_State_5" class="radio-label_Hopeful"></label>
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_5_5" class="radio-label_Mid_5" value="5.5">
	<label for="Emotional_State_5_5" class="radio-label_Mid_5"></label>
	
	<input type="radio" name="attr_Emotional_State" id="Emotional_State_6" class="radio-label_Pleased" value="6">
	<label for="Emotional_State_6" class="radio-label_Pleased"></label>
</div>

<div class="sheet-backpack">
	<input class="ClComb_Dmg" type="text" name="attr_ClComb_Dmg" value="">
	<button type="roll" class="Roll_ClComb_Dmg" name="roll_ClDamage" value="&{template:ATDW} {{title=Close Combat DMG}} {{subtitle=}} {{color=}} {{[[1d10+@{ClComb_Dmg}+@{Bonus_Dmg}]]}} {{desc=}}"></button>
	<input class="RaComb_Dmg" type="text" name="attr_RaComb_Dmg" value="">
	<button type="roll" class="Roll_RaComb_Dmg" name="roll_RaDamage" value="&{template:ATDW} {{title=Range Combat DMG}} {{subtitle=}} {{color=}} {{[[1d10+@{RaComb_Dmg}+@{Bonus_Dmg}]]}} {{desc=}}"></button>

   <input class="ClCombWeap" type="text" name="attr_ClCombWeap" value="Knife">
   <input class="RaCombWeap" type="text" name="attr_RaCombWeap" value="Knife">

   <input class="Equip_Head" type="text" name="attr_Equip_Head" value="">
   <input class="Equip_Torso" type="text" name="attr_Equip_Torso" value="">
   <input class="Equip_Waist" type="text" name="attr_Equip_Waist" value="">
   <input class="Equip_Back" type="text" name="attr_Equip_Back" value="">
   <input class="Equip_RHand" type="text" name="attr_Equip_RHand" value="">
   <input class="Equip_LHand" type="text" name="attr_Equip_LHand" value="">
   <input class="Equip_Legs" type="text" name="attr_Equip_Legs" value="">
   <input class="Equip_Feet" type="text" name="attr_Equip_Feet" value="">
   
   <input class="Equip_Body_Suit" type="text" name="attr_Equip_Body_Suit" value="">
   <input class="Drake_Coins" type="text" name="attr_Drake_Coins" value="">
	
   <input class="Backpack_Qua_00" type="text" name="attr_Backpack_Qua_00" value="">
   <input class="Backpack_Obj_00" type="text" name="attr_Backpack_Obj_00" value="">
	
   <input class="Backpack_Qua_01" type="text" name="attr_Backpack_Qua_01" value="">
   <input class="Backpack_Obj_01" type="text" name="attr_Backpack_Obj_01" value="">
	
   <input class="Backpack_Qua_02" type="text" name="attr_Backpack_Qua_02" value="">
   <input class="Backpack_Obj_02" type="text" name="attr_Backpack_Obj_02" value="">
	
   <input class="Backpack_Qua_03" type="text" name="attr_Backpack_Qua_03" value="">
   <input class="Backpack_Obj_03" type="text" name="attr_Backpack_Obj_03" value="">
	
   <input class="Backpack_Qua_04" type="text" name="attr_Backpack_Qua_04" value="">
   <input class="Backpack_Obj_04" type="text" name="attr_Backpack_Obj_04" value="">
	
   <input class="Backpack_Qua_10" type="text" name="attr_Backpack_Qua_10" value="">
   <input class="Backpack_Obj_10" type="text" name="attr_Backpack_Obj_10" value="">
	
   <input class="Backpack_Qua_11" type="text" name="attr_Backpack_Qua_11" value="">
   <input class="Backpack_Obj_11" type="text" name="attr_Backpack_Obj_11" value="">
	
   <input class="Backpack_Qua_12" type="text" name="attr_Backpack_Qua_12" value="">
   <input class="Backpack_Obj_12" type="text" name="attr_Backpack_Obj_12" value="">
	
   <input class="Backpack_Qua_13" type="text" name="attr_Backpack_Qua_13" value="">
   <input class="Backpack_Obj_13" type="text" name="attr_Backpack_Obj_13" value="">
	
   <input class="Backpack_Qua_14" type="text" name="attr_Backpack_Qua_14" value="">
   <input class="Backpack_Obj_14" type="text" name="attr_Backpack_Obj_14" value="">
	
   <input class="Backpack_Qua_20" type="text" name="attr_Backpack_Qua_20" value="">
   <input class="Backpack_Obj_20" type="text" name="attr_Backpack_Obj_20" value="">
	
   <input class="Backpack_Qua_21" type="text" name="attr_Backpack_Qua_21" value="">
   <input class="Backpack_Obj_21" type="text" name="attr_Backpack_Obj_21" value="">
	
   <input class="Backpack_Qua_22" type="text" name="attr_Backpack_Qua_22" value="">
   <input class="Backpack_Obj_22" type="text" name="attr_Backpack_Obj_22" value="">
	
   <input class="Backpack_Qua_23" type="text" name="attr_Backpack_Qua_23" value="">
   <input class="Backpack_Obj_23" type="text" name="attr_Backpack_Obj_23" value="">
	
   <input class="Backpack_Qua_24" type="text" name="attr_Backpack_Qua_24" value="">
   <input class="Backpack_Obj_24" type="text" name="attr_Backpack_Obj_24" value="">
	
   <input class="Pockets_Qua_00" type="text" name="attr_Pockets_Qua_00" value="">
   <input class="Pockets_Obj_00" type="text" name="attr_Pockets_Obj_00" value="">
	
   <input class="Pockets_Qua_01" type="text" name="attr_Pockets_Qua_01" value="">
   <input class="Pockets_Obj_01" type="text" name="attr_Pockets_Obj_01" value="">
	
   <input class="Pockets_Qua_02" type="text" name="attr_Pockets_Qua_02" value="">
   <input class="Pockets_Obj_02" type="text" name="attr_Pockets_Obj_02" value="">
	
   <input class="Pockets_Qua_03" type="text" name="attr_Pockets_Qua_03" value="">
   <input class="Pockets_Obj_03" type="text" name="attr_Pockets_Obj_03" value="">
	
   <input class="Pockets_Qua_04" type="text" name="attr_Pockets_Qua_04" value="">
   <input class="Pockets_Obj_04" type="text" name="attr_Pockets_Obj_04" value="">
	
   <input class="Pockets_Qua_10" type="text" name="attr_Pockets_Qua_10" value="">
   <input class="Pockets_Obj_10" type="text" name="attr_Pockets_Obj_10" value="">
	
   <input class="Pockets_Qua_11" type="text" name="attr_Pockets_Qua_11" value="">
   <input class="Pockets_Obj_11" type="text" name="attr_Pockets_Obj_11" value="">
	
   <input class="Pockets_Qua_12" type="text" name="attr_Pockets_Qua_12" value="">
   <input class="Pockets_Obj_12" type="text" name="attr_Pockets_Obj_12" value="">
	
   <input class="Pockets_Qua_13" type="text" name="attr_Pockets_Qua_13" value="">
   <input class="Pockets_Obj_13" type="text" name="attr_Pockets_Obj_13" value="">
	
   <input class="Pockets_Qua_14" type="text" name="attr_Pockets_Qua_14" value="">
   <input class="Pockets_Obj_14" type="text" name="attr_Pockets_Obj_14" value="">
</div>

<script type="text/worker">
   const buttonlist = ["character","backpack"];
   buttonlist.forEach(button => {
       on(`clicked:${button}`, function() {
           setAttrs({
               sheetTab: button
           });
       });
   });
</script>
   
<script type="text/worker">
   on("sheet:opened change:Emotional_State", function () {
      getAttrs(["Emotional_State", "Skill_ArTech", "Skill_ClComb", "Skill_Percept", "Skill_Manipul", "Skill_MedAid", "Skill_Pilot", "Skill_RaComb", "Skill_Resolve", "Skill_Science", "Skill_Stealth", "Skill_Survival", "Skill_Techno", "Stamina"], function (values) {
      
         let Emotional_State  = values.Emotional_State;
         
         <!-- let Emo_ASkill       = 0; -->
         <!-- let Emo_Dmg          = 0; -->
         <!-- let Emo_Rslv         = 0; -->
         <!-- let Emo_Stam         = 0; -->
         <!-- let Emo_CbtSkill     = 0; -->
         <!-- let Emo_Manip        = 0; -->
         <!-- let Emo_NonCbtSkill  = 0; -->
         
         switch (Emotional_State) {
            case "0" :  <!--Hopeless-->
               Emo_ASkill     = -2;
               Emo_Dmg        = "1d4";
               Emo_Rslv       = 0;
               Emo_Stam       = 0;
               Emo_CbtSkill   = 0;
               Emo_Manip      = 0;
               Emo_NonCbtSkill= 0;
               break;
            case "1" :  <!--Enraged-->
               Emo_ASkill     = 0;
               Emo_Dmg        = 0;
               Emo_Rslv       = 0;
               Emo_Stam       = 0;
               Emo_CbtSkill   = +1;
               Emo_Manip      = -1;
               Emo_NonCbtSkill= 0;
               break;         
            case "2" :  <!--Nervous-->
               Emo_ASkill     = 0;
               Emo_Dmg        = 0;
               Emo_Rslv       = -1;
               Emo_Stam       = +1;
               Emo_CbtSkill   = 0;
               Emo_Manip      = 0;
               Emo_NonCbtSkill= 0;
               break;         
            case "3" :  <!--Composed-->
               Emo_ASkill     = 0;
               Emo_Dmg        = 0;
               Emo_Rslv       = 0;
               Emo_Stam       = 0;
               Emo_CbtSkill   = 0;
               Emo_Manip      = 0;
               Emo_NonCbtSkill= 0;
               break;         
            case "4" :  <!--Calm-->
               Emo_ASkill     = 0;
               Emo_Dmg        = 0;
               Emo_Rslv       = 0;
               Emo_Stam       = 0;
               Emo_CbtSkill   = -1;
               Emo_Manip      = +1;
               Emo_NonCbtSkill= 0;
               break;         
            case "5" :  <!--Hopeful-->
               Emo_ASkill     = 0;
               Emo_Dmg        = 0;
               Emo_Rslv       = 0;
               Emo_Stam       = 0;
               Emo_CbtSkill   = -1;
               Emo_Manip      = 0;
               Emo_NonCbtSkill= +1;
               break;
            case "6" :  <!--Pleased-->
               Emo_ASkill     = +2;
               Emo_Dmg        = 0;
               Emo_Rslv       = 0;
               Emo_Stam       = 0;
               Emo_CbtSkill   = 0;
               Emo_Manip      = 0;
               Emo_NonCbtSkill= 0;
               break;
         }
         var Bonus_ArTech  = parseInt(Emo_ASkill) + parseInt(Emo_NonCbtSkill);
         var Bonus_ClComb  = parseInt(Emo_ASkill) + parseInt(Emo_CbtSkill);
         var Bonus_Percept = parseInt(Emo_ASkill) + parseInt(Emo_NonCbtSkill);
         var Bonus_Manipul = parseInt(Emo_ASkill) + parseInt(Emo_NonCbtSkill) + parseInt(Emo_Manip);
         var Bonus_MedAid  = parseInt(Emo_ASkill) + parseInt(Emo_NonCbtSkill);
         var Bonus_Pilot   = parseInt(Emo_ASkill) + parseInt(Emo_NonCbtSkill);
         var Bonus_RaComb  = parseInt(Emo_ASkill) + parseInt(Emo_CbtSkill);
         var Bonus_Resolve = parseInt(Emo_ASkill) + parseInt(Emo_NonCbtSkill) + parseInt(Emo_Rslv);
         var Bonus_Science = parseInt(Emo_ASkill) + parseInt(Emo_NonCbtSkill);
         var Bonus_Stealth = parseInt(Emo_ASkill) + parseInt(Emo_NonCbtSkill);
         var Bonus_Survival= parseInt(Emo_ASkill) + parseInt(Emo_NonCbtSkill);
         var Bonus_Techno  = parseInt(Emo_ASkill) + parseInt(Emo_NonCbtSkill);
         <!-- var Bonus_Stamina = parseInt(values.Stamina) + parseInt(Emo_Stam); -->
         var Bonus_Dmg     = Emo_Dmg;
         setAttrs({
            "Skill_Bonus_ArTech"    : Bonus_ArTech,
            "Skill_Bonus_ClComb"    : Bonus_ClComb,
            "Skill_Bonus_Percept"   : Bonus_Percept,
            "Skill_Bonus_Manipul"   : Bonus_Manipul,
            "Skill_Bonus_MedAid"    : Bonus_MedAid,
            "Skill_Bonus_Pilot"     : Bonus_Pilot,
            "Skill_Bonus_RaComb"    : Bonus_RaComb,
            "Skill_Bonus_Resolve"   : Bonus_Resolve,
            "Skill_Bonus_Science"   : Bonus_Science,
            "Skill_Bonus_Stealth"   : Bonus_Stealth,
            "Skill_Bonus_Survival"  : Bonus_Survival,
            "Skill_Bonus_Techno"    : Bonus_Techno,
            <!-- "Bonus_Stamina"         : Bonus_Stamina, -->
            "Bonus_Dmg"             : Bonus_Dmg
         });
      });
   });
</script>

<script type="text/worker">
   on("sheet:opened change:Advantage", function () {
      getAttrs(["Advantage"], function (values) {
      
         let Advantage  = values.Advantage;
         
         switch (Advantage) {
            case "0" :  <!--Disadvantage-->
               AdvQuant = 2;
               AdvSelc  = "kl1";    <!--Keep Low quantity : 1-->
               break;
            case "1" :  <!--Standard-->
               AdvQuant = 1;
               AdvSelc  = "";
               break;
            case "2" :  <!--Advantage-->
               AdvQuant = 2;
               AdvSelc  = "kh1";    <!--Keep High quantity : 1-->
               break;
         }
         setAttrs({
            "AdvQuant"  : AdvQuant,
            "AdvSelc"   : AdvSelc,
         });
      });
   });
</script>
